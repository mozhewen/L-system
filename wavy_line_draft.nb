(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24103,        570]
NotebookOptionsPosition[     22210,        532]
NotebookOutlinePosition[     22546,        547]
CellTagsIndexPosition[     22503,        544]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{"N", "@", 
    RowBox[{"CirclePoints", "[", 
     RowBox[{"1", ",", 
      RowBox[{"4", "*", "32"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.791627103334361*^9, 3.7916272062297173`*^9}, {
   3.7916280105628347`*^9, 3.791628011430108*^9}, {3.791628329116066*^9, 
   3.79162833277871*^9}, {3.791628436622534*^9, 3.791628472532943*^9}, {
   3.791628565705289*^9, 3.791628565882525*^9}, 3.791628740581455*^9, {
   3.791628785537208*^9, 3.791628794276886*^9}, {3.79162883124333*^9, 
   3.791628853350911*^9}, {3.791629067063794*^9, 3.791629087412949*^9}, {
   3.7916292552739077`*^9, 3.7916292568594847`*^9}, {3.791940807251707*^9, 
   3.791940814643064*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"819f1bee-b41c-4fe0-af36-217c5974620f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pA", "=", 
   RowBox[{"points", "\[LeftDoubleBracket]", 
    RowBox[{"1", ";;", ";;", "4"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pB", "=", 
   RowBox[{
    RowBox[{"points", "\[LeftDoubleBracket]", 
     RowBox[{"2", ";;", ";;", "4"}], "\[RightDoubleBracket]"}], "*", 
    "1.2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pC", "=", 
   RowBox[{"points", "\[LeftDoubleBracket]", 
    RowBox[{"3", ";;", ";;", "4"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pD", "=", 
   RowBox[{
    RowBox[{"points", "\[LeftDoubleBracket]", 
     RowBox[{"4", ";;", ";;", "4"}], "\[RightDoubleBracket]"}], "*", 
    "0.8"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.791627209865641*^9, 3.79162721416648*^9}, {
   3.791627310705676*^9, 3.7916273965070477`*^9}, {3.791627750035886*^9, 
   3.791627751594705*^9}, {3.791628021247843*^9, 3.791628061508765*^9}, 
   3.791628112491214*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"4bdfc58d-b047-4878-bc95-3455f546142f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BSplineCurve", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pA", ",", "pB", ",", "pC", ",", "pD"}], "}"}], 
         "\[Transpose]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"SplineClosed", "\[Rule]", "True"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PointSize", "[", "Medium", "]"}], ",", "\[IndentingNewLine]", 
    "Red", ",", 
    RowBox[{"Point", "[", "pA", "]"}], ",", "\[IndentingNewLine]", "Green", 
    ",", 
    RowBox[{"Point", "[", "pB", "]"}], ",", "\[IndentingNewLine]", "Blue", 
    ",", 
    RowBox[{"Point", "[", "pC", "]"}], ",", "\[IndentingNewLine]", "Black", 
    ",", 
    RowBox[{"Point", "[", "pD", "]"}], ",", "\[IndentingNewLine]", "Dashed", 
    ",", 
    RowBox[{"Circle", "[", "]"}]}], "\[IndentingNewLine]", "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.791627398439711*^9, 3.791627453878824*^9}, {
  3.7916276516722927`*^9, 3.7916276637567673`*^9}, {3.791627706895422*^9, 
  3.791627711310541*^9}, {3.791627766768359*^9, 3.7916277996057568`*^9}, {
  3.791628068015369*^9, 3.791628072253194*^9}, {3.791628133075005*^9, 
  3.791628162514817*^9}, {3.79162819958083*^9, 3.791628227395899*^9}, {
  3.791628282469059*^9, 3.791628385159033*^9}, {3.791628486576889*^9, 
  3.791628491711426*^9}, {3.7916287773412523`*^9, 3.791628781715085*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"5ec74712-af14-4ad4-b376-24cb16ba7463"],

Cell[BoxData[
 GraphicsBox[{BSplineCurveBox[CompressedData["
1:eJw91PtLFQYYxnEVBlabVDZsi7w0ppQtGsksz/LZUnNiF5MVEQV1vGx08RSL
IoIoMaYVBKaYDUooKrMLZdRm0NOkjDYvsww37HZO2vFYxzO1XEplBe+zH17e
P+D74YlxurLzQoKCgna+u/d/R/7R/5bGVOKjpqLVxa8DjIu6nrGi8hJKIhOa
3Z8PMOyn6mWLlhF3jrg35tYHODvf9Vf1rt9xxRVXPnmOjzmLd6wtHNOIkq7c
0wOzA9z/3JFya3sbCkqT+2J39TMkP6JsZXgbxru/e1bs7GVm65oViRtu48/g
9vgtHi/3+E+mbAv8g6RbC1sTvvXz8LyiFx0pbgzNjUpfHdvHukMvO47tfYhp
5a7T19qfcm1NfHR2bgcOBaeG363q4sPx9xd8sMGDwrj5VSem9jD1Zuybl0e8
mFFz7mp9Wi99XY+v/PGkEwUVI2PCHN3s+qxz7NBxN7Y17htav8fDipFAYugX
XjyYPnnp5bFPmLW4cfOpcD8i0h+kD0zw8VVOacaUJB9+y4qeOnzuMVuy19VG
9XbiYNGMs47t9xkU8vHy0aOeYkrmpO9rI92s3Xev6fjFf+EaXNPj9Hv4YlxC
TGb5M6y6/mVlQcM9liclb171gxehV6O/KmMb59Y3Xgrv8ONw2vDM3aHtTK6L
fx7p6EfLo+5OR8TfzMn40ftNey+2Dp533h7XSseSnpKVw93I+jCv+BdXA6sz
Nw3n/hxAA/amTvDc4MQDdSlfhw0gNG1klrOpnknFwWeafAEMftJcGn33AjeN
TlxYVeFD3q+F02s+LaN1hxxYd8iBdYccWHfIgXWHHFh3yIF1hxxYd8iBdYcc
WHfIgXWHHFh3yIF1hxxYd8iBdYccWHfIgXWHHFh3yIF1hxxYd8iBdYccWHfI
gXWHHFh3yIF1hxxYd8iBdYccWHfIgXWHHFh3yIF1hxxYd8iBdf/fgXWnHFh3
yoF1pxxYd8qBdaccWHfKgXWnHFh3yoF1pxxYd8qBdaccWHfKgXWnHFh3yoF1
pxxYd8qBdaccWHfKgXWnHFh3yoF1pxxYd8qBdaccWHfKgXWnHFh3yoF1pxxY
d8qBdaccWHfKgXWnHGj35UC7LwfafTnQ7suBdl8OtPtyoN2XA+2+HGj35UC7
LwfafTnQ7suBdl8OtPtyoN2XA+2+HGj35UC7LwfafTnQ7suBdl8OtPtyoN2X
A+2+HGj35UC7LwfafTnQ7suBdl8OtPtyoN2XA+2+HLwF2IhBzg==
    "],
    SplineClosed->True], 
   {RGBColor[1, 0, 0], PointSize[Medium], PointBox[CompressedData["
1:eJw90L1LgnEUxfEHITAjEMspknQJoaAhSIQ4ROaiIkhCo5Q1BBGNLg5i9PYH
SIsIDSW4CTVeCBQCHZoipCKhAuPhNzgIQvQC9zRc7vj9cPyb+6lth2VZM7/3
9/M7F4O0/xzj7WLm+MvIVjK/Wxhr4eQtW+uHjJzaV6s584jwXeJ+ccWWF89T
fGSvi8JstHIZ7Enp2yw55z/wPDedvnG/i+XwbrhGPxGITa3Xfa+yfNu6nujY
KK8NFw6dD1KNHQyzRwZNnEUmuw3RLujQLujQLujQLujQLujQLujQLujQLujQ
7r9Du0KHdoUO7Qod2hU6tCt0aFfo0K7Qwd3p4O50cHc6uDsd3J0O7k4Hd6eD
u9PxAwUwBH0=
     "]], 
    {RGBColor[0, 1, 0], PointBox[CompressedData["
1:eJw90D9IAgEUx/HDqcnFwCa1oXMQXHQ780GXHE6Ko5MeuOrS5iS0BIFgU0tt
DjY0FA0OPhBBBLWlIVBERdACRT0TW/oH79fweOP3w+/QzCUyNkVRPL/3973u
RjR5/UQXrmB3dGRxcaPprfwLZUvhlVpY883J+UdPH9HnsdtIqSs+bapfu9sp
+e/ua/XIguOx9lnFMSenMTCs/Td+uOx3yo9Lym3T7+Z8zOGqb+PS1vQ8nE00
5ysfXFX1kN2ivch3wOzUWboEh3QJDukSHNIlOKRLcEiX4JAuwSFdgkO6/w7p
MhzSZTiky3BIl+GQLsMhXYZDugwHdocDu8OB3eHA7nBgdziwOxzYHQ7sDscP
LiQakQ==
      "]]}, 
    {RGBColor[0, 0, 1], PointBox[CompressedData["
1:eJw90D1LQgEUxvGrayBYQ7hd22oTnGw4jkog0eCUy/UFJxUa/AqCmyhiS0uL
UIhu5XAkxEFQUBMHBRFfL4pOiYhgCedpOJzx/+OxatGHoFFRFPXvTt/0lPd6
vEydl1Es8LVhY+gy/XjxTecj1yqhrfnzedd/TQ7pJhN9q/SWrE/H5fpsQpHs
8cx0u+CDP+W+cuj0ca9e7wtj/jHbrXeZFfmqtlykNmC/Ozx39tYU3xa1trnF
joThvaFvaGtpptRuiaVLcEiX4JAuwSFdgkO6BId0CQ7pEhzSJTik+++QLsMh
XYZDugyHdBkO6TIc0mU4pMtwYHc4sDsc2B0O7A4HdocDu8OB3eHA7nD8AnPO
IJk=
      "]]}, 
    {GrayLevel[0], PointBox[CompressedData["
1:eJw90D9IAgEUx/HTKaRBcAuiEwcHxbGrhN7iJkLdKDoonkF/OIIQpKlwsHBU
lFxuCkJwcRGEHi4uBVYoDdGgeJgO7TqV8H4Ojzd+P/y8aVM3nIqiqP+3+ntZ
8+3ppksd01/Z3p9x9D0V1y4+6MXxGciNp3zaCKh65oseHBHP0LLZ9k3ci8cR
5V9Li/P7Mff1s9bO74RqhVAzfP3NlYPDq+TJlDae1d0yDzh8PL9LLH/oaNMo
1s0eX7q0mFWdkdG+DTa2yixdgkO6BId0CQ7pEhzSJTikS3BIl+CQLsEh3bVD
ugyHdBkO6TIc0mU4pMtwSJfhkC7Dgd3hwO5wYHc4sDsc2B0O7A4HdocDu8Px
B/ILBzE=
      "]], 
     {Dashing[{Small, Small}], CircleBox[{0, 0}]}}}}]], "Output",
 CellChangeTimes->{
  3.79162742401082*^9, 3.79162745445306*^9, 3.791627711787489*^9, 
   3.791627754134122*^9, 3.791628076687953*^9, 3.791628120159379*^9, {
   3.791628150187873*^9, 3.791628162976899*^9}, {3.791628203137885*^9, 
   3.791628228938161*^9}, {3.791628289563815*^9, 3.7916283384325743`*^9}, {
   3.791628380095837*^9, 3.791628385551784*^9}, {3.7916284334214582`*^9, 
   3.79162849306919*^9}, 3.7916285687394342`*^9, 3.7916287431979637`*^9, {
   3.7916287826726713`*^9, 3.791628797324667*^9}, {3.791628834356616*^9, 
   3.7916288569370832`*^9}, {3.791629069676978*^9, 3.791629090888479*^9}, 
   3.7916292597001*^9, 3.791940495689828*^9, {3.7919408097825537`*^9, 
   3.7919408169476357`*^9}},
 CellLabel->"Out[80]=",ExpressionUUID->"193f40fa-d9b2-4048-afe6-5e9989d8e853"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"Arrow", "[", 
    RowBox[{"BSplineCurve", "[", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pA", ",", "pB", ",", "pC", ",", "pD"}], "}"}], 
          "\[Transpose]"}], ",", "1"}], "]"}], ",", 
       RowBox[{"First", "@", "pA"}]}], "]"}], "]"}], "]"}], 
   "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.791628588171124*^9, 3.791628589025243*^9}, {
  3.791628674047481*^9, 3.791628702863896*^9}, {3.7916289566753063`*^9, 
  3.791628958370817*^9}, {3.791629034543915*^9, 3.791629056902829*^9}, {
  3.7919405248543167`*^9, 3.7919405277014914`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"192a93a7-d05f-4861-a573-48cd18e28064"],

Cell[BoxData[
 GraphicsBox[ArrowBox[BSplineCurveBox[CompressedData["
1:eJxd0k8ow3EYx/GlcfCnSCKaUmtx2WFEKzz0a/PnsJpSXCTbToqjEi7zMxI5
LC5bSJukjHLYAY+UKI2YwxLF/tgP7Y9JO5hCPc8ODt+e66v351szNNpjyZHJ
ZHW/7+92LWo1kbJ98Ayq1PicwPHvVMYbu4agYLeat1No2tpxBycDoF/QXA0v
xdDePds+dXwHPqfi5t4fwXhcpu84D0NpoiXc2ithqLpcV1Efg1djg603KWFb
rivvtvMNHOpPyeB9xNX8E9eBOwpWW58orfjxsiotbioScPFld809+dDhDxkK
lR+gLNE16yu9SC5gZ8BzKp8JS7CREYzr0TN2ATv7G5edkYEkxJtUewPFWRew
MzXvk2vXHkFAs9UyFmIXsFO4kJ/fmx4gbTNOFB2+swvYOVKgrp0u2QVVpXhk
EV/YlXVSP6R+7EJ2Uj+kfuxCdlI/pH7sQnZSP6R+7EJ2Uj+kftld2Un9kPqx
i3dG6ofUj128M1I/pH7s4p2R+iH1YxfvjNQPqR/+/38/9A5qrQ==
   "]]]]], "Output",
 CellChangeTimes->{
  3.791628589426846*^9, {3.791628676004204*^9, 3.791628703424156*^9}, 
   3.791628958774928*^9, {3.7916290582969418`*^9, 3.791629093038221*^9}, 
   3.791629261409515*^9, 3.791940498197732*^9, 3.7919405282996817`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"932f39eb-c6e9-4b3e-9c1a-5f72bc95f93b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"ReIm", "@", 
    RowBox[{"RandomComplex", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB", "=", 
   RowBox[{"ReIm", "@", 
    RowBox[{"RandomComplex", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "=", 
   RowBox[{"ReIm", "@", 
    RowBox[{"RandomComplex", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DD", "=", 
   RowBox[{"ReIm", "@", 
    RowBox[{"RandomComplex", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EE", "=", 
   RowBox[{"ReIm", "@", 
    RowBox[{"RandomComplex", "[", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7919392779813423`*^9, 3.79193933171738*^9}, {
  3.791939502298835*^9, 3.791939534956994*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"33160c69-8358-4687-a9e9-45cbae8f8fb8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Point", "[", 
     RowBox[{"{", 
      RowBox[{"AA", ",", "BB", ",", "CC", ",", "DD", ",", "EE"}], "}"}], 
     "]"}], ",", "Black", ",", "\[IndentingNewLine]", 
    RowBox[{"BSplineCurve", "[", 
     RowBox[{"{", 
      RowBox[{"AA", ",", "BB", ",", "CC", ",", "DD", ",", "EE"}], "}"}], 
     "]"}], ",", "Thick", ",", "Dashed", ",", "Blue", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"BezierCurve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"AA", ",", "BB", ",", "CC", ",", "DD", ",", "EE"}], "}"}], ",", 
      RowBox[{"SplineDegree", "\[Rule]", "4"}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.791939272456047*^9, 3.791939274962829*^9}, {
  3.791939321966915*^9, 3.791939579144288*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"5a2bbaa3-d1d5-40bd-86ce-de60f78da555"],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], PointSize[Large], 
   PointBox[{{0.0613314934297573, 0.06036156662099157}, {0.01313747345966898, 
    0.05780642850778417}, {0.5876609335083212, 0.6223509360511066}, {
    0.23472116525179398`, 0.9712944956393952}, {0.06727428471716124, 
    0.9782168167589951}}], 
   {GrayLevel[0], 
    BSplineCurveBox[{{0.0613314934297573, 0.06036156662099157}, {
     0.01313747345966898, 0.05780642850778417}, {0.5876609335083212, 
     0.6223509360511066}, {0.23472116525179398`, 0.9712944956393952}, {
     0.06727428471716124, 0.9782168167589951}}]}, 
   {RGBColor[0, 0, 1], Thickness[Large], Dashing[{Small, Small}], 
    BezierCurveBox[{{0.0613314934297573, 0.06036156662099157}, {
     0.01313747345966898, 0.05780642850778417}, {0.5876609335083212, 
     0.6223509360511066}, {0.23472116525179398`, 0.9712944956393952}, {
     0.06727428471716124, 0.9782168167589951}},
     SplineDegree->4]}}]], "Output",
 CellChangeTimes->{{3.7919393420562897`*^9, 3.7919395795141497`*^9}, 
   3.7919405101660767`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"31540cdf-c137-48fd-97e7-f60cd65c5837"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "WavyLine", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WavyLine", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1_List", ",", "p2_List"}], "}"}], ",", "pitch_", ",", 
    "width_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vec", "=", 
       RowBox[{"p2", "-", "p1"}]}], ",", "pts", ",", "newHead", ",", "num"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"num", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"2", " ", 
        RowBox[{
         RowBox[{"Norm", "[", "vec", "]"}], "/", "pitch"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pts", "=", 
      RowBox[{
       RowBox[{"newHead", "@@", "p1"}], "+", 
       RowBox[{
        RowBox[{"Subdivide", "[", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"num", "==", "0"}], ",", "1", ",", 
           RowBox[{"2", "num"}]}], "]"}], "]"}], "*", 
        RowBox[{"newHead", "@@", "vec"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"num", ">", "0"}], ",", 
       RowBox[{
        RowBox[{"pts", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", ";;", "4"}], "\[RightDoubleBracket]"}], "+=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"newHead", "@@", 
           RowBox[{"AngleVector", "[", 
            RowBox[{
             RowBox[{"ArcTan", "@@", "vec"}], "+", 
             FractionBox["\[Pi]", "2"]}], "]"}]}], ")"}], "*", "width"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"num", ">", "1"}], ",", 
       RowBox[{
        RowBox[{"pts", "\[LeftDoubleBracket]", 
         RowBox[{"4", ";;", ";;", "4"}], "\[RightDoubleBracket]"}], "-=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"newHead", "@@", 
           RowBox[{"AngleVector", "[", 
            RowBox[{
             RowBox[{"ArcTan", "@@", "vec"}], "+", 
             FractionBox["\[Pi]", "2"]}], "]"}]}], ")"}], "*", "width"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BSplineCurve", "[", "pts", "]"}], "/.", 
      RowBox[{"newHead", "\[Rule]", "List"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzksowwEABvA1c2IeY2whG0uh7DKLTDa1rLBhOXAgamKtGVM0s9FqKY/y
zBy2KTHDwsEjKa8D1kqhvFIeB9ooWiHP//c/fP3q6zt83PrmChWVQqFwiECr
maYbEAckMi2TVCThbdsJgytlpAV/VUcw9KbHB9Wj9jsY3tD9ACWqjCcoHreR
nkew3qDi/eUTFuquGQ5CQ2RjDKRu9rNh0aI7AeYqralwpcCfA0+8rnzI2pqV
woDrqwtqBBwTTObrLZBHcfXB4upsH9xQ6o7hnNV/DYe92kc4X3LPdBLSDjRs
GGeUc+HFTVo6XFiTCKCY8yGFjqCnlOyNKgVMUZsroXCZWU3ufFe1MITV3AYn
v+sMUK6M7YS3xjcTfM386Yc1Y4cjkHO2ZCN/MDanYeKpexaK4rdXoXNdtA4L
PfQdGFaeTSqMmmiaInymX2rheYuzFcq+4/Tw177cDie0pwbYMZnUCzWGsSE4
2JQ1A/P280lpUZZdyBdH78F/Ugb+7Q==
  
  "],ExpressionUUID->"717db633-4a16-4935-a6af-e804ea516b24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"WavyLine", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", ".3", ",", "0.1"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.791979640823978*^9, 3.791979654656798*^9}, {
  3.791979739729895*^9, 3.791979746941119*^9}, {3.791979987077878*^9, 
  3.791980006286956*^9}, {3.791981394697774*^9, 3.791981406597147*^9}, {
  3.791981467469352*^9, 3.791981497239045*^9}, {3.79198153310538*^9, 
  3.7919815770189257`*^9}, {3.7919816737116537`*^9, 3.791981680350301*^9}, {
  3.791981716356879*^9, 3.791981716718638*^9}, {3.791981919197879*^9, 
  3.791981926596966*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"6cfe4916-22f7-47cc-be2e-d28fe7e5ba3c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", "\[IndentingNewLine]", "rs", "\[IndentingNewLine]", "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.791977540936418*^9, 3.7919775575552187`*^9}, {
  3.791979441275927*^9, 3.791979462793603*^9}, {3.791979627649838*^9, 
  3.79197965981983*^9}, {3.791980050819688*^9, 3.791980052611948*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"a993a251-129d-4755-9747-02cbf76bb7c3"],

Cell[BoxData[
 GraphicsBox[
  BSplineCurveBox[
   NCache[{{0, 0}, {-0.1, 0.07142857142857142}, {0, Rational[1, 7]}, {0.1, 
     0.21428571428571427`}, {0, Rational[2, 7]}, {-0.1, 
     0.35714285714285715`}, {0, Rational[3, 7]}, {0.1, 0.5}, {
     0, Rational[4, 7]}, {-0.1, 0.6428571428571429}, {0, Rational[5, 7]}, {
     0.1, 0.7857142857142857}, {0, Rational[6, 7]}, {-0.1, 
     0.9285714285714286}, {0, 1}}, {{0, 0}, {-0.1, 0.07142857142857142}, {
     0, 0.14285714285714285`}, {0.1, 0.21428571428571427`}, {
     0, 0.2857142857142857}, {-0.1, 0.35714285714285715`}, {
     0, 0.42857142857142855`}, {0.1, 0.5}, {0, 0.5714285714285714}, {-0.1, 
     0.6428571428571429}, {0, 0.7142857142857143}, {0.1, 
     0.7857142857142857}, {0, 0.8571428571428571}, {-0.1, 
     0.9285714285714286}, {0, 1}}]],
  ImageSize->{44.07903439153439, Automatic}]], "Output",
 CellChangeTimes->{
  3.7919818572675953`*^9, {3.79198192052246*^9, 3.791981928299221*^9}},
 CellLabel->
  "Out[233]=",ExpressionUUID->"79f1ceb9-b27b-4472-a371-24675b79eddb"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "WavyCircle", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WavyCircle", "[", 
   RowBox[{"center_List", ",", "radius_", ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]1_", ",", "\[Theta]2_"}], "}"}], ",", "pitch_", ",", 
    "width_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Delta]", "=", 
       RowBox[{"\[Theta]2", "-", "\[Theta]1"}]}], ",", "pts", ",", "newHead", 
      ",", "num"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"num", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"2", " ", "\[Delta]", " ", 
        RowBox[{"radius", "/", "pitch"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pts", "=", 
      RowBox[{"(", 
       RowBox[{"AngleVector", "/@", 
        RowBox[{"(", 
         RowBox[{"\[Theta]1", "+", 
          RowBox[{
           RowBox[{"Subdivide", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"num", "==", "0"}], ",", "1", ",", 
              RowBox[{"2", "num"}]}], "]"}], "]"}], "*", "\[Delta]"}]}], 
         ")"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"num", ">", "0"}], ",", 
       RowBox[{
        RowBox[{"pts", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", ";;", "4"}], "\[RightDoubleBracket]"}], "*=", 
        FractionBox[
         RowBox[{"radius", "-", "width"}], "radius"]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"num", ">", "1"}], ",", 
       RowBox[{
        RowBox[{"pts", "\[LeftDoubleBracket]", 
         RowBox[{"4", ";;", ";;", "4"}], "\[RightDoubleBracket]"}], "*=", 
        FractionBox[
         RowBox[{"radius", "+", "width"}], "radius"]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BSplineCurve", "[", "pts", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7919819553710318`*^9, 3.7919819598626328`*^9}, {
   3.7919819929429617`*^9, 3.79198203663903*^9}, {3.7919820931657677`*^9, 
   3.791982129048407*^9}, {3.79198237171954*^9, 3.791982391588422*^9}, {
   3.791982750880639*^9, 3.791982897632812*^9}, 3.791982936675041*^9, {
   3.791982995533286*^9, 3.791983056141667*^9}, {3.7919831055681047`*^9, 
   3.791983124527512*^9}, {3.7919831620395412`*^9, 3.791983195999938*^9}, {
   3.791983255548902*^9, 3.791983257390704*^9}, {3.791983290477306*^9, 
   3.791983500965948*^9}, {3.791983541962488*^9, 3.7919835670275927`*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"04c1329f-b92f-4618-a2dd-a5c6c02363b1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"WavyCircle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", ".01"}], "}"}], ",", "0.1", ",", "0.1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Point", "@@", "rs"}], ",", "\[IndentingNewLine]", "rs"}], 
   "\[IndentingNewLine]", "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7919831349804287`*^9, 3.791983231562118*^9}, {
   3.7919832728556213`*^9, 3.791983273860693*^9}, {3.791983505236974*^9, 
   3.791983519197302*^9}, 3.791983588770236*^9},
 CellLabel->
  "In[361]:=",ExpressionUUID->"ce07ed7c-3076-401c-91ff-f8d22fc904a3"],

Cell[BoxData[
 GraphicsBox[{
   PointBox[{{1., 0.}, {0.9999500004166653, 0.009999833334166664}}], 
   BSplineCurveBox[{{1., 0.}, {0.9999500004166653, 
    0.009999833334166664}}]}]], "Output",
 CellChangeTimes->{{3.791983149612854*^9, 3.791983198180278*^9}, 
   3.791983231948308*^9, {3.791983264512911*^9, 3.791983295894842*^9}, {
   3.79198332679102*^9, 3.791983519699936*^9}, {3.791983584539361*^9, 
   3.791983593942124*^9}},
 CellLabel->
  "Out[362]=",ExpressionUUID->"21255deb-bee6-4a6a-93db-1e66ff38f5c2"]
}, Open  ]]
},
WindowSize->{1052, 876},
WindowMargins->{{Automatic, 176}, {73, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 806, 15, 31, "Input",ExpressionUUID->"819f1bee-b41c-4fe0-af36-217c5974620f"],
Cell[1367, 37, 1087, 27, 101, "Input",ExpressionUUID->"4bdfc58d-b047-4878-bc95-3455f546142f"],
Cell[CellGroupData[{
Cell[2479, 68, 1550, 33, 216, "Input",ExpressionUUID->"5ec74712-af14-4ad4-b376-24cb16ba7463"],
Cell[4032, 103, 3988, 73, 376, "Output",ExpressionUUID->"193f40fa-d9b2-4048-afe6-5e9989d8e853"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8057, 181, 850, 19, 78, "Input",ExpressionUUID->"192a93a7-d05f-4861-a573-48cd18e28064"],
Cell[8910, 202, 948, 16, 368, "Output",ExpressionUUID->"932f39eb-c6e9-4b3e-9c1a-5f72bc95f93b"]
}, Open  ]],
Cell[9873, 221, 861, 23, 124, "Input",ExpressionUUID->"33160c69-8358-4687-a9e9-45cbae8f8fb8"],
Cell[CellGroupData[{
Cell[10759, 248, 1025, 23, 147, "Input",ExpressionUUID->"5a2bbaa3-d1d5-40bd-86ce-de60f78da555"],
Cell[11787, 273, 1129, 20, 449, "Output",ExpressionUUID->"31540cdf-c137-48fd-97e7-f60cd65c5837"]
}, Open  ]],
Cell[12931, 296, 2925, 76, 239, "Input",ExpressionUUID->"717db633-4a16-4935-a6af-e804ea516b24"],
Cell[15859, 374, 852, 20, 31, "Input",ExpressionUUID->"6cfe4916-22f7-47cc-be2e-d28fe7e5ba3c"],
Cell[CellGroupData[{
Cell[16736, 398, 428, 8, 78, "Input",ExpressionUUID->"a993a251-129d-4755-9747-02cbf76bb7c3"],
Cell[17167, 408, 1038, 19, 226, "Output",ExpressionUUID->"79f1ceb9-b27b-4472-a371-24675b79eddb"]
}, Open  ]],
Cell[18220, 430, 2667, 64, 269, "Input",ExpressionUUID->"04c1329f-b92f-4618-a2dd-a5c6c02363b1"],
Cell[CellGroupData[{
Cell[20912, 498, 767, 19, 124, "Input",ExpressionUUID->"ce07ed7c-3076-401c-91ff-f8d22fc904a3"],
Cell[21682, 519, 512, 10, 449, "Output",ExpressionUUID->"21255deb-bee6-4a6a-93db-1e66ff38f5c2"]
}, Open  ]]
}
]
*)

